---
- name: Check argspec validation with filter (missing arg)
  ansible.builtin.set_fact:
    _result1: "{{ ansible.utils.usable_range('') }}"
  ignore_errors: true
  register: result1

- name: Assert
  ansible.builtin.assert:
    that: "{{ msg in result1.msg }}"
  vars:
    msg: "does not appear to be an IPv4 or IPv6 network"

- name: Check argspec validation with filter (random string arg)
  ansible.builtin.set_fact:
    _result2: "{{ ansible.utils.usable_range('helloworld') }}"
  ignore_errors: true
  register: result2

- name: Assert
  ansible.builtin.assert:
    that: "{{ msg in result2.msg }}"
  vars:
    msg: "does not appear to be an IPv4 or IPv6 network"

- name: Check argspec validation with filter (invalid arg for expansion)
  ansible.builtin.set_fact:
    _result3: "{{ ansible.utils.usable_range('192.168.1.25/24') }}"
  ignore_errors: true
  register: result3

- name: Assert
  ansible.builtin.assert:
    that: "{{ msg in result3.msg }}"
  vars:
    msg: "has host bits set"

- name: Check argspec validation with filter (invalid format for arg)
  ansible.builtin.set_fact:
    _result4: "{{ ansible.utils.usable_range('192.0.2.0/23/24') }}"
  ignore_errors: true
  register: result4

- name: Assert
  ansible.builtin.assert:
    that: "{{ msg in result4.msg }}"
  vars:
    msg: "does not appear to be an IPv4 or IPv6 network"

- name: Check argspec validation with filter (invalid format for arg)
  ansible.builtin.set_fact:
    _result5: "{{ ansible.utils.usable_range('::/20/30') }}"
  ignore_errors: true
  register: result5

- name: Assert
  ansible.builtin.assert:
    that: "{{ msg in result5.msg }}"
  vars:
    msg: "does not appear to be an IPv4 or IPv6 network"

- name: Check argspec validation with filter (invalid netmask)
  ansible.builtin.set_fact:
    _result6: "{{ ansible.utils.usable_range('10.0.0.0/322') }}"
  ignore_errors: true
  register: result6

- name: Assert
  ansible.builtin.assert:
    that: "{{ msg in result6.msg }}"
  vars:
    msg: "does not appear to be an IPv4 or IPv6 network"

- name: Check argspec validation with filter (invalid netmask)
  ansible.builtin.set_fact:
    _result7: "{{ ansible.utils.usable_range('2001:db8:abcd:0012::0/129') }}"
  ignore_errors: true
  register: result7

- name: Assert
  ansible.builtin.assert:
    that: "{{ msg in result7.msg }}"
  vars:
    msg: "does not appear to be an IPv4 or IPv6 network"
